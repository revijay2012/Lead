import{d as e,j as s}from"./index-BgRM5gx4.js";import{r as t}from"./react-vendor-DtX1tuCI.js";import{n as a,x as l,j as i,k as r}from"./firebase-vendor-C5ggpXef.js";import{X as c,r as n,P as d,M as x,U as m,T as o,j as h,k as j}from"./ui-vendor-DFpyUtHP.js";async function u(s){const t=i(e,"leads",s,"activities");return(await r(t)).docs.map(e=>({activity_id:e.id,...e.data()}))}async function p(s){const t=i(e,"leads",s,"proposals");return(await r(t)).docs.map(e=>({proposal_id:e.id,...e.data()}))}async function g(s){const t=i(e,"leads",s,"contracts");return(await r(t)).docs.map(e=>({contract_id:e.id,...e.data()}))}function y({result:i,isOpen:r,onClose:y,className:N=""}){const[f,v]=t.useState(null),[b,w]=t.useState([]),[_,S]=t.useState([]),[$,k]=t.useState([]),[C,D]=t.useState(!1),[L,A]=t.useState(null);if(t.useEffect(()=>{if(!i||!r)return v(null),w([]),S([]),void k([]);(async()=>{D(!0),A(null);try{let s=null;switch(i.type){case"lead":if(s=await async function(s){const t=a(e,"leads",s),i=await l(t);return i.exists()?{lead_id:s,...i.data()}:null}(i.id),s){const[e,s,t]=await Promise.all([u(i.id),p(i.id),g(i.id)]);w(e),S(s),k(t)}break;case"activity":i.lead_id&&(s=await async function(s,t){const i=a(e,"leads",s,"activities",t),r=await l(i);return r.exists()?{activity_id:t,...r.data()}:null}(i.lead_id,i.id));break;case"proposal":i.lead_id&&(s=await async function(s,t){const i=a(e,"leads",s,"proposals",t),r=await l(i);return r.exists()?{proposal_id:t,...r.data()}:null}(i.lead_id,i.id));break;case"contract":i.lead_id&&(s=await async function(s,t){const i=a(e,"leads",s,"contracts",t),r=await l(i);return r.exists()?{contract_id:t,...r.data()}:null}(i.lead_id,i.id))}v(s)}catch(s){A(s instanceof Error?s.message:"Failed to load details")}finally{D(!1)}})()},[i,r]),!r||!i)return null;const F=e=>{if(!e)return"N/A";try{return(e.toDate?e.toDate():new Date(e)).toLocaleString()}catch(s){return"Invalid date"}},P=e=>{switch(e.toLowerCase()){case"customer":case"active":case"accepted":return"bg-green-100 text-green-800";case"new":case"draft":case"pending":return"bg-yellow-100 text-yellow-800";case"lost":case"expired":case"rejected":case"cancelled":return"bg-red-100 text-red-800";case"contacted":case"qualified":case"proposal":case"negotiation":case"sent":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return s.jsxs("div",{className:`fixed inset-0 z-50 overflow-hidden ${N}`,children:[s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:y}),s.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-2xl bg-white shadow-xl transform transition-transform",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Details"}),s.jsx("button",{onClick:y,className:"p-2 text-gray-400 hover:text-gray-600 focus:outline-none",children:s.jsx(c,{className:"h-6 w-6"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[C&&s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading details..."})]})}),L&&s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-red-500 mb-4",children:"⚠️"}),s.jsx("p",{className:"text-red-600 mb-2",children:"Failed to load details"}),s.jsx("p",{className:"text-gray-600 text-sm",children:L})]})}),f&&!C&&!L&&s.jsxs(s.Fragment,{children:["lead"===i.type&&(O=f,s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[O.first_name," ",O.last_name]}),s.jsx("p",{className:"text-gray-600",children:O.email})]}),s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${P(O.status)}`,children:O.status})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(d,{className:"h-5 w-5 text-gray-400 mr-3"}),s.jsx("span",{className:"text-gray-900",children:O.phone||"N/A"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(x,{className:"h-5 w-5 text-gray-400 mr-3"}),s.jsx("span",{className:"text-gray-900",children:O.email})]}),O.company&&s.jsxs("div",{className:"flex items-center",children:[s.jsx(m,{className:"h-5 w-5 text-gray-400 mr-3"}),s.jsx("span",{className:"text-gray-900",children:O.company})]}),O.title&&s.jsxs("div",{className:"flex items-center",children:[s.jsx(o,{className:"h-5 w-5 text-gray-400 mr-3"}),s.jsx("span",{className:"text-gray-900",children:O.title})]})]}),s.jsxs("div",{className:"space-y-4",children:[O.source&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Source"}),s.jsx("p",{className:"text-gray-900",children:O.source})]}),O.notes&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Notes"}),s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:O.notes})]}),O.tags&&O.tags.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Tags"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:O.tags.map((e,t)=>s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e},t))})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Created"}),s.jsx("p",{className:"text-gray-900",children:F(O.created_at)})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Last Updated"}),s.jsx("p",{className:"text-gray-900",children:F(O.updated_at)})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[s.jsx(h,{className:"h-5 w-5 mr-2"}),"Activities (",b.length,")"]}),b.length>0?s.jsx("div",{className:"space-y-3",children:b.map(e=>s.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.subject}),s.jsx("p",{className:"text-sm text-gray-600",children:e.notes})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${P(e.type)}`,children:e.type}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:F(e.timestamp)})]})]})},e.activity_id))}):s.jsx("p",{className:"text-gray-500 text-sm",children:"No activities found"})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[s.jsx(j,{className:"h-5 w-5 mr-2"}),"Proposals (",_.length,")"]}),_.length>0?s.jsx("div",{className:"space-y-3",children:_.map(e=>s.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.title}),s.jsx("p",{className:"text-sm text-gray-600",children:e.description}),e.value&&s.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["$",e.value.toLocaleString()]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${P(e.status)}`,children:e.status}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:F(e.created_at)})]})]})},e.proposal_id))}):s.jsx("p",{className:"text-gray-500 text-sm",children:"No proposals found"})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center",children:[s.jsx(j,{className:"h-5 w-5 mr-2"}),"Contracts (",$.length,")"]}),$.length>0?s.jsx("div",{className:"space-y-3",children:$.map(e=>s.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.title}),s.jsx("p",{className:"text-sm text-gray-600",children:e.type}),e.value&&s.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["$",e.value.toLocaleString()]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${P(e.status)}`,children:e.status}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:F(e.start_date)})]})]})},e.contract_id))}):s.jsx("p",{className:"text-gray-500 text-sm",children:"No contracts found"})]})]})]})),"activity"===i.type&&(U=f,s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:U.subject}),s.jsxs("p",{className:"text-gray-600",children:["Activity • ",U.lead_name]})]}),s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${P(U.type)}`,children:U.type})]}),U.notes&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Notes"}),s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:U.notes})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Date"}),s.jsx("p",{className:"text-gray-900",children:F(U.timestamp)})]}),U.duration&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Duration"}),s.jsxs("p",{className:"text-gray-900",children:[U.duration," minutes"]})]}),U.outcome&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Outcome"}),s.jsx("p",{className:"text-gray-900",children:U.outcome})]}),U.next_follow_up&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Next Follow-up"}),s.jsx("p",{className:"text-gray-900",children:F(U.next_follow_up)})]})]})]})),"proposal"===i.type&&(E=f,s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:E.title}),s.jsxs("p",{className:"text-gray-600",children:["Proposal • ",E.lead_name]})]}),s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${P(E.status)}`,children:E.status})]}),E.notes&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Notes"}),s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:E.notes})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Sent Date"}),s.jsx("p",{className:"text-gray-900",children:F(E.sent_at)})]}),E.amount&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Amount"}),s.jsxs("p",{className:"text-gray-900",children:[E.currency||"$",E.amount.toLocaleString()]})]}),E.valid_until&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Valid Until"}),s.jsx("p",{className:"text-gray-900",children:F(E.valid_until)})]}),E.terms&&s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Terms"}),s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:E.terms})]})]})]})),"contract"===i.type&&(T=f,s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Contract"}),s.jsxs("p",{className:"text-gray-600",children:["Contract • ",T.lead_name]})]}),s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${P(T.status)}`,children:T.status})]}),T.notes&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Notes"}),s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:T.notes})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Start Date"}),s.jsx("p",{className:"text-gray-900",children:F(T.start_date)})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"End Date"}),s.jsx("p",{className:"text-gray-900",children:F(T.end_date)})]}),T.renewal_date&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Renewal Date"}),s.jsx("p",{className:"text-gray-900",children:F(T.renewal_date)})]}),T.amount&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Amount"}),s.jsxs("p",{className:"text-gray-900",children:[T.currency||"$",T.amount.toLocaleString()]})]}),void 0!==T.auto_renew&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Auto Renew"}),s.jsx("p",{className:"text-gray-900",children:T.auto_renew?"Yes":"No"})]}),T.terms&&s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Terms"}),s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:T.terms})]})]})]}))]}),!f&&!C&&!L&&s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:"📄"}),s.jsx("p",{className:"text-gray-600",children:"No details available"})]})})]}),s.jsx("div",{className:"border-t border-gray-200 p-6",children:s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:y,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Close"}),i.lead_id&&s.jsxs("button",{onClick:()=>{window.open(`/leads/${i.lead_id}`,"_blank")},className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx(n,{className:"h-4 w-4 inline mr-2"}),"View Full Details"]})]})})]})]});var T,E,U,O}export{y as ResultDetailDrawer};
